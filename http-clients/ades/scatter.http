@app_cwl_href=https://raw.githubusercontent.com/EO-DataHub/eodh-workflows/main/cwl_files/water-quality-app.cwl
@app_name=scatter-water-quality
@ades_url=https://test.eodatahub.org.uk/ades


### List Processes
GET {{ades_url}}/{{username}}/ogc-api/processes
Accept: application/json
Authorization: Bearer {{token}}

### Unregister Process
DELETE {{ades_url}}/{{username}}/ogc-api/processes/{{app_name}}
Accept: application/json
Authorization: Bearer {{token}}

### Register Process
POST {{ades_url}}/{{username}}/ogc-api/processes
Accept: application/json
Authorization: Bearer {{token}}
Content-Type: application/cwl+yaml

< scatter-water-quality.cwl

### Get Process details
GET {{ades_url}}/{{username}}/ogc-api/processes/{{app_name}}
Accept: application/json
Authorization: Bearer {{token}}

### Execute Process
POST {{ades_url}}/{{username}}/ogc-api/processes/{{app_name}}/execution
Accept: application/json
Authorization: Bearer {{token}}
Content-Type: application/json
Prefer: respond-async

{
    "inputs": {
        "workspace": "{{username}}",
        "stac_collection": "sentinel-2-l2a-ard",
        "areas": [
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.9832150934786466, 51.38881182250657], [-0.9832150934786466, 51.34193872534333], [-1.1832150934786465, 51.37251771878215], [-1.1649837883356766, 51.38881182250657], [-0.9832150934786466, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.9832150934786466, 51.38881182250657], [-1.1649837883356766, 51.38881182250657], [-0.9832150934786466, 51.551266344803615], [-0.9832150934786466, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.9832150934786466, 51.38881182250657], [-0.7832150934786466, 51.38881182250657], [-0.7832150934786466, 51.31135973190451], [-0.9832150934786466, 51.34193872534333], [-0.9832150934786466, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.7832150934786466, 51.58881182250657], [-0.7832150934786466, 51.38881182250657], [-0.9832150934786466, 51.38881182250657], [-0.9832150934786466, 51.551266344803615], [-0.9632395483098258, 51.569119351068395], [-0.9422102039403532, 51.58881182250657], [-0.7832150934786466, 51.58881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.7832150934786466, 51.58881182250657], [-0.9422102039403532, 51.58881182250657], [-0.7832150934786466, 51.737699330199014], [-0.7832150934786466, 51.58881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.7832150934786466, 51.38881182250657], [-0.5832150934786466, 51.38881182250657], [-0.5832150934786466, 51.280780738465694], [-0.7832150934786466, 51.31135973190451], [-0.7832150934786466, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.7832150934786466, 51.38881182250657], [-0.7832150934786466, 51.58881182250657], [-0.5832150934786466, 51.58881182250657], [-0.5832150934786466, 51.38881182250657], [-0.7832150934786466, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.5832150934786466, 51.58881182250657], [-0.7832150934786466, 51.58881182250657], [-0.7832150934786466, 51.737699330199014], [-0.7289177719343433, 51.78854487416342], [-0.5832150934786466, 51.765991781040235], [-0.5832150934786466, 51.58881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.5832150934786466, 51.38881182250657], [-0.38321509347864663, 51.38881182250657], [-0.38321509347864663, 51.25020174502688], [-0.5832150934786466, 51.280780738465694], [-0.5832150934786466, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.5832150934786466, 51.38881182250657], [-0.5832150934786466, 51.58881182250657], [-0.38321509347864663, 51.58881182250657], [-0.38321509347864663, 51.38881182250657], [-0.5832150934786466, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.38321509347864663, 51.58881182250657], [-0.5832150934786466, 51.58881182250657], [-0.5832150934786466, 51.765991781040235], [-0.38321509347864663, 51.735034089167684], [-0.38321509347864663, 51.58881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.18321509347864662, 51.188811822506565], [-0.18321509347864662, 51.02254638590855], [-0.2794025274589274, 51.03093527261069], [-0.2976343179626166, 51.188811822506565], [-0.18321509347864662, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.38321509347864663, 51.38881182250657], [-0.18321509347864662, 51.38881182250657], [-0.18321509347864662, 51.188811822506565], [-0.2976343179626166, 51.188811822506565], [-0.30331291280336437, 51.23798510373379], [-0.38321509347864663, 51.25020174502688], [-0.38321509347864663, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.38321509347864663, 51.38881182250657], [-0.38321509347864663, 51.58881182250657], [-0.18321509347864662, 51.58881182250657], [-0.18321509347864662, 51.38881182250657], [-0.38321509347864663, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.18321509347864662, 51.58881182250657], [-0.38321509347864663, 51.58881182250657], [-0.38321509347864663, 51.735034089167684], [-0.18321509347864662, 51.70407639729513], [-0.18321509347864662, 51.58881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.18321509347864662, 52.48076751182258], [-0.23636383383894063, 52.562719381794636], [-0.18321509347864662, 52.56251226770997], [-0.18321509347864662, 52.48076751182258]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.18321509347864662, 51.188811822506565], [0.016784906521353393, 51.188811822506565], [0.016784906521353393, 51.00510359456875], [-0.18321509347864662, 51.02254638590855], [-0.18321509347864662, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[-0.18321509347864662, 51.188811822506565], [-0.18321509347864662, 51.38881182250657], [0.016784906521353393, 51.38881182250657], [0.016784906521353393, 51.188811822506565], [-0.18321509347864662, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.016784906521353393, 51.38881182250657], [-0.18321509347864662, 51.38881182250657], [-0.18321509347864662, 51.58881182250657], [0.016784906521353393, 51.58881182250657], [0.016784906521353393, 51.530078979808714], [-0.04986282815233196, 51.417274312437314], [0.016784906521353393, 51.41534082964739], [0.016784906521353393, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.016784906521353393, 51.788811822506574], [0.016784906521353393, 51.58881182250657], [-0.18321509347864662, 51.58881182250657], [-0.18321509347864662, 51.70407639729513], [-0.1741968319434045, 51.70268047448596], [-0.07807535887694096, 51.788811822506574], [0.016784906521353393, 51.788811822506574]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.016784906521353393, 51.788811822506574], [-0.07807535887694096, 51.788811822506574], [0.016784906521353393, 51.87381304306318], [0.016784906521353393, 51.788811822506574]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.016784906521353393, 52.44360691386228], [-0.16463267780562957, 52.45211464624799], [-0.18321509347864662, 52.48076751182258], [-0.18321509347864662, 52.56251226770997], [0.016784906521353393, 52.56173289238229], [0.016784906521353393, 52.44360691386228]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.016784906521353393, 51.188811822506565], [0.2167849065213534, 51.188811822506565], [0.2167849065213534, 50.993956202491184], [0.20358725649870044, 50.98881182250656], [0.016784906521353393, 51.00510359456875], [0.016784906521353393, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.016784906521353393, 51.188811822506565], [0.016784906521353393, 51.38881182250657], [0.2167849065213534, 51.38881182250657], [0.2167849065213534, 51.188811822506565], [0.016784906521353393, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.016784906521353393, 51.58881182250657], [0.016784906521353393, 51.788811822506574], [0.2167849065213534, 51.788811822506574], [0.2167849065213534, 51.743855838135694], [0.06968909856985324, 51.61962200502634], [0.0514856951320782, 51.58881182250657], [0.016784906521353393, 51.58881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.2167849065213534, 51.98881182250658], [0.2167849065213534, 51.788811822506574], [0.016784906521353393, 51.788811822506574], [0.016784906521353393, 51.87381304306318], [0.11272779218983979, 51.959784364683486], [0.1852606824023732, 51.98881182250658], [0.2167849065213534, 51.98881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.2167849065213534, 51.98881182250658], [0.1852606824023732, 51.98881182250658], [0.2167849065213534, 52.0014277279715], [0.2167849065213534, 51.98881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.2167849065213534, 52.43422774324079], [0.016784906521353393, 52.44360691386228], [0.016784906521353393, 52.56173289238229], [0.2167849065213534, 52.56095351705461], [0.2167849065213534, 52.43422774324079]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.2167849065213534, 51.188811822506565], [0.4167849065213534, 51.188811822506565], [0.4167849065213534, 51.071915232709266], [0.2167849065213534, 50.993956202491184], [0.2167849065213534, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.4167849065213534, 51.188811822506565], [0.2167849065213534, 51.188811822506565], [0.2167849065213534, 51.38881182250657], [0.3941541259570035, 51.38881182250657], [0.4167849065213534, 51.377391067612805], [0.4167849065213534, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.2167849065213534, 51.38881182250657], [0.2167849065213534, 51.409538733598986], [0.3613957997719849, 51.405343502137555], [0.3941541259570035, 51.38881182250657], [0.2167849065213534, 51.38881182250657]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.2167849065213534, 51.788811822506574], [0.27001385935797245, 51.788811822506574], [0.2167849065213534, 51.743855838135694], [0.2167849065213534, 51.788811822506574]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.2167849065213534, 51.788811822506574], [0.2167849065213534, 51.98881182250658], [0.4167849065213534, 51.98881182250658], [0.4167849065213534, 51.838390144212696], [0.3327033373586603, 51.84175795507221], [0.27001385935797245, 51.788811822506574], [0.2167849065213534, 51.788811822506574]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.4167849065213534, 51.98881182250658], [0.2167849065213534, 51.98881182250658], [0.2167849065213534, 52.0014277279715], [0.3040108749453361, 52.03633531420013], [0.4167849065213534, 52.079278230381995], [0.4167849065213534, 51.98881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.4167849065213534, 52.424848572619304], [0.2167849065213534, 52.43422774324079], [0.2167849065213534, 52.56095351705461], [0.4167849065213534, 52.56017414172693], [0.4167849065213534, 52.424848572619304]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.4167849065213534, 51.188811822506565], [0.6167849065213534, 51.188811822506565], [0.6167849065213534, 51.14987426292735], [0.4167849065213534, 51.071915232709266], [0.4167849065213534, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.6167849065213534, 51.188811822506565], [0.4167849065213534, 51.188811822506565], [0.4167849065213534, 51.377391067612805], [0.6167849065213534, 51.27645990563819], [0.6167849065213534, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.4167849065213534, 51.98881182250658], [0.6167849065213534, 51.98881182250658], [0.6167849065213534, 51.83037932592504], [0.4167849065213534, 51.838390144212696], [0.4167849065213534, 51.98881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.6167849065213534, 51.98881182250658], [0.4167849065213534, 51.98881182250658], [0.4167849065213534, 52.079278230381995], [0.6167849065213534, 52.155435685394885], [0.6167849065213534, 51.98881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.6167849065213534, 52.4163254571348], [0.5192043430452693, 52.42004552576873], [0.4167849065213534, 52.424848572619304], [0.4167849065213534, 52.56017414172693], [0.5096401889074943, 52.55981229614625], [0.6167849065213534, 52.552184347303815], [0.6167849065213534, 52.4163254571348]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.6167849065213534, 51.188811822506565], [0.7166772717041804, 51.188811822506565], [0.6167849065213534, 51.14987426292735], [0.6167849065213534, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.6167849065213534, 51.188811822506565], [0.6167849065213534, 51.27645990563819], [0.7583081964896391, 51.20503935512335], [0.7166772717041804, 51.188811822506565], [0.6167849065213534, 51.188811822506565]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.6167849065213534, 51.98881182250658], [0.8167849065213535, 51.98881182250658], [0.8167849065213535, 51.82236850763738], [0.6167849065213534, 51.83037932592504], [0.6167849065213534, 51.98881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.8167849065213535, 52.18881182250658], [0.8167849065213535, 51.98881182250658], [0.6167849065213534, 51.98881182250658], [0.6167849065213534, 52.155435685394885], [0.7044352543593723, 52.18881182250658], [0.8167849065213535, 52.18881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.8167849065213535, 52.18881182250658], [0.7044352543593723, 52.18881182250658], [0.8167849065213535, 52.23159314040778], [0.8167849065213535, 52.18881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.8167849065213535, 52.4087008472711], [0.6167849065213534, 52.4163254571348], [0.6167849065213534, 52.552184347303815], [0.8167849065213535, 52.537945756709135], [0.8167849065213535, 52.4087008472711]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.8167849065213535, 51.98881182250658], [0.98826090160118, 51.98881182250658], [0.8491676607984998, 51.82107144583654], [0.8167849065213535, 51.82236850763738], [0.8167849065213535, 51.98881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[0.8167849065213535, 51.98881182250658], [0.8167849065213535, 52.18881182250658], [1.0167849065213534, 52.18881182250658], [1.0167849065213534, 52.023210527302275], [0.98826090160118, 51.98881182250658], [0.8167849065213535, 51.98881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[1.0167849065213534, 52.38881182250658], [1.0167849065213534, 52.18881182250658], [0.8167849065213535, 52.18881182250658], [0.8167849065213535, 52.23159314040778], [0.8204751983851757, 52.2329983565908], [0.8939224587262756, 52.38881182250658], [1.0167849065213534, 52.38881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[1.0167849065213534, 52.38881182250658], [0.8939224587262756, 52.38881182250658], [0.9017705085562614, 52.405460936973356], [0.8167849065213535, 52.4087008472711], [0.8167849065213535, 52.537945756709135], [1.0167849065213534, 52.52370716611445], [1.0167849065213534, 52.38881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[1.0167849065213534, 52.18881182250658], [1.154104383729864, 52.18881182250658], [1.0167849065213534, 52.023210527302275], [1.0167849065213534, 52.18881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[1.0167849065213534, 52.18881182250658], [1.0167849065213534, 52.38881182250658], [1.2167849065213534, 52.38881182250658], [1.2167849065213534, 52.26440179684498], [1.154104383729864, 52.18881182250658], [1.0167849065213534, 52.18881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[1.2167849065213534, 52.38881182250658], [1.0167849065213534, 52.38881182250658], [1.0167849065213534, 52.52370716611445], [1.2167849065213534, 52.50946857551977], [1.2167849065213534, 52.38881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[1.2167849065213534, 52.38881182250658], [1.3199478658585482, 52.38881182250658], [1.2167849065213534, 52.26440179684498], [1.2167849065213534, 52.38881182250658]]]}",
            "{\"type\": \"Polygon\", \"coordinates\": [[[1.2167849065213534, 52.38881182250658], [1.2167849065213534, 52.50946857551977], [1.4086706778583264, 52.49580766082471], [1.3199478658585482, 52.38881182250658], [1.2167849065213534, 52.38881182250658]]]}"
        ],
        "date_start": "2022-01-03",
        "date_end": "2024-12-01",
        "limit": "3",
        "clip": "true"
    }
}

> {%

    client.global.set("execute_process_response", response.body);

%}

### List Jobs
GET {{ades_url}}/{{username}}/ogc-api/jobs
Accept: application/json
Authorization: Bearer {{token}}

### Get Job status
GET https://test.eodatahub.org.uk/ades/{{username}}/ogc-api/jobs/{{execute_process_response.jobID}}
Authorization: Bearer {{token}}
Content-Type: application/json

> {%

    client.global.set("job_status", response.body);

%}

### Get Job status by ID
GET https://test.eodatahub.org.uk/ades/{{username}}/ogc-api/jobs/1eaee5c6-d416-11ef-b416-7acca6d0ccd7
Authorization: Bearer {{token}}
Content-Type: application/json

> {%

    client.global.set("job_status", response.body);

%}

### Get Job results
GET https://test.eodatahub.org.uk/ades/{{username}}/ogc-api/jobs/{{execute_process_response.jobID}}/results
Authorization: Bearer {{token}}
Content-Type: application/json

### Get Job Logs
GET {{job_status.links[2].href}}
Accept: application/json
Authorization: Bearer {{token}}

### Get Job Stage Out Logs
GET {{job_status.links[3].href}}
Accept: application/json
Authorization: Bearer {{token}}

### Get Failed Job Logs
GET {{job_status.links[1].href}}
Accept: application/json
Authorization: Bearer {{token}}

### Get Failed Job Stage Out Logs
GET {{job_status.links[2].href}}
Accept: application/json
Authorization: Bearer {{token}}

### Cancel Job
DELETE {{ades_url}}/{{username}}/ogc-api/jobs/1eaee5c6-d416-11ef-b416-7acca6d0ccd7
Accept: application/json
Authorization: Bearer {{token}}
